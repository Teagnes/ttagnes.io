# 大数据总结



## 

## hive

### 新增字段不生效

在低版本的hive中，修改了表结构并新增字段后，只有在新增的分区中识别到，在历史的分区中查询时会抛错没有改字段，而在spark中则无此问题

### 删除分区不释放空间

在使用`alter table tablename drop if exists partition(date<=20190909)` 命令删除分区时，只会删除分区元信息，但是数据不会被删除，导致空间没有被释放，这里不要使用 `<=` 来删除多个分区，而是一个个删除分区则没有改问题，而且诡异的是如果使用spark则可以里历史的分区中识别到字段





## spark
### spark为什么比hive快
```
问：spark和hive原理上有什么不同，为什么spark更快？
答：hive使用的是mr，基于的是磁盘，而spark是基于内存，更快
问：还有什么程序数据不是放在内存里的？
答：...
```
从计算的原理上来说，spark和hive并没有本质的不同，两者都是基于MapReduce的分而治之的思想，不同的是，hive转换成mapreduce时，需要将reduce的结果保存到磁盘上，而spark则可以将结果暂时保存在内存中，在需要进行复杂的计算多个mr的计算过程时，hive需要反复从磁盘上加载数据，而spark的数据则一直在内存中，上次计算的结果直接作为下次计算的输入，节省了反复的磁盘io时间，也就是说，如果只是单纯的简单的一次mr计算，两者的速度可能并没有明显区别，甚至极端情况下hive甚至可以比spark更快，



